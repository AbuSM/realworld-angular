<div class="article-page">
    <div class="banner">
        <div class="container">
            <h1>{{ article.title }}</h1>
            <app-article-meta [article]="article">
                <span [hidden]="(canModify$ | async) === false">
                    <button
                        class="btn btn-sm btn-outline-secondary m-1"
                        [routerLink]="['/editor', article.slug]"
                    >
                        <i class="ion-edit"></i>
                        Edit Article
                    </button>

                    <button
                        class="btn btn-sm btn-outline-danger m-1"
                        (click)="openModal()"
                    >
                        <i class="ion-trash-a"></i>
                        Delete Article
                    </button>
                </span>
                <span [hidden]="canModify$ | async">
                    <app-follow-button
                        [profile]="article.author"
                        (toggle)="onToggleFollowing($event)"
                    >
                    </app-follow-button>

                    <app-favorite-button
                        [article]="article"
                        (toggle)="onToggleFavorite($event)"
                    >
                        {{ article.favorited ? "Unfavorite" : "Favorite" }}
                        Article
                        <span class="counter"
                            >({{ article.favoritesCount }})</span
                        >
                    </app-favorite-button>
                </span>
            </app-article-meta>
        </div>
    </div>

    <div class="container page">
        <div class="row article-content">
            <div class="col-md-12">
                <div [innerHTML]="article.body"></div>

                <ul class="tag-list">
                    <li
                        *ngFor="let tag of article.tagList"
                        class="tag-default tag-pill tag-outline"
                    >
                        {{ tag }}
                    </li>
                </ul>
            </div>
        </div>

        <hr />

        <div class="article-actions">
            <app-article-meta [article]="article">
                <span [hidden]="(canModify$ | async) === false">
                    <button
                        class="btn btn-sm btn-outline-secondary m-1"
                        [routerLink]="['/editor', article.slug]"
                    >
                        <i class="ion-edit"></i>
                        Edit Article
                    </button>

                    <button
                        class="btn btn-sm btn-outline-danger m-1"
                        [ngClass]="{ disabled: false }"
                        (click)="openModal()"
                        data-toggle="modal"
                        data-target="#modal_confirm"
                    >
                        <i class="ion-trash-a"></i>
                        Delete Article
                    </button>
                </span>

                <span [hidden]="canModify$ | async">
                    <app-follow-button
                        [profile]="article.author"
                        (toggle)="onToggleFollowing($event)"
                    >
                    </app-follow-button>

                    <app-favorite-button
                        [article]="article"
                        (toggle)="onToggleFavorite($event)"
                    >
                        {{ article.favorited ? "Unfavorite" : "Favorite" }}
                        Article
                        <span class="counter"
                            >({{ article.favoritesCount }})</span
                        >
                    </app-favorite-button>
                </span>
            </app-article-meta>
        </div>

        <!--        <div class="row">-->
        <!--            <div class="col-xs-12 col-md-8 offset-md-2">-->

        <!--                <div *appShowAuthed="true">-->
        <!--                    <app-errors-list [errors]="commentErrors"></app-errors-list>-->
        <!--                    <form class="card comment-form" (ngSubmit)="addComment()">-->
        <!--                        <fieldset [disabled]="isSubmitting">-->
        <!--                            <div class="card-block">-->
        <!--                <textarea class="form-control"-->
        <!--                          placeholder="Write a comment..."-->
        <!--                          rows="3"-->
        <!--                          [formControl]="commentControl"-->
        <!--                >-->

        <!--                </textarea>-->
        <!--                            </div>-->
        <!--                            <div class="card-footer">-->
        <!--                                <img [src]="currentUser.image" class="comment-author-img"/>-->
        <!--                                <button class="btn btn-sm btn-primary" type="submit">-->
        <!--                                    Post Comment-->
        <!--                                </button>-->
        <!--                            </div>-->
        <!--                        </fieldset>-->
        <!--                    </form>-->
        <!--                </div>-->

        <!--                <div *appShowAuthed="false">-->
        <!--                    <a [routerLink]="['/login']">Sign in</a> or <a [routerLink]="['/register']">sign up</a> to add-->
        <!--                    comments on this article.-->
        <!--                </div>-->

        <!--                <app-article-comment-->
        <!--                    *ngFor="let comment of comments"-->
        <!--                    [comment]="comment"-->
        <!--                    (deleteComment)="onDeleteComment(comment)">-->
        <!--                </app-article-comment>-->

        <!--            </div>-->
        <!--        </div>-->
    </div>
</div>

<ng-container #vc></ng-container>
<ng-template #modal_confirm>
    <div
        class="modal show"
        aria-labelledby="modal_confirm"
        tabindex="-1"
        role="dialog"
        id="modal_confirm"
    >
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Confirm your action</h5>
                    <button
                        type="button"
                        class="close"
                        data-dismiss="modal"
                        aria-label="Close"
                        (click)="closeModal()"
                    >
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <p>Are you sure, you want to delete this article?</p>
                </div>
                <div class="modal-footer">
                    <button
                        type="button"
                        class="btn btn-danger"
                        (click)="onDeleteArticle()"
                    >
                        <app-spinner [loading]="isLoading"></app-spinner>
                        Yes
                    </button>
                    <button
                        type="button"
                        class="btn btn-secondary"
                        data-dismiss="modal"
                        (click)="closeModal()"
                    >
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>
</ng-template>
